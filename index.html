<!DOCTYPE html>
<!--[if lte IE 6]><html lang="en" class="preIE7 preIE8 preIE9 preIE11"><![endif]-->
<!--[if IE 7]><html lang="en" class="preIE8 preIE9 preIE11"><![endif]-->
<!--[if IE 8]><html lang="en" class="preIE9 preIE11"><![endif]-->
<!--[if IE 9]><html lang="en" class="preIE11"><![endif]-->
<!--[if IE 10]><html lang="en" class="preIE11"><![endif]-->
<!--[if gte IE 11]><!--><html lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<!-- browser/device compatibility stuff -->
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="x-dns-prefetch-control" content="on">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="HandheldFriendly" content="True"/>
<meta name="format-detection" content="telephone=no">
<!-- page info -->
<title>mdsh</title>
<meta name="description" content="mdsh - a simple static site generator for modern websites, written in Bash.">
<meta name="keywords" content="mdsh, static site generator, project page, open source, blog, news, feed">
<meta name="news_keywords" content="mdsh, static site generator, project page, open source, blog, news, feed">
<meta name="subject" content="blog, blog, bash, shell, javascript, css, programming, puppy linux, test, games">
<meta name="generator" content="bl" />
<meta name="medium" content="blog">
<meta name="copyright" content="&copy; mdsh">
<meta name="language" content="en">
<meta name="robots" content="index,follow">
<meta name="topic" content="blog, bash, shell, javascript, css, programming, puppy linux, test, games">
<meta name="owner" content="sc0ttj">
<meta name="pagename" content="mdsh">
 <!-- Apple -->
<meta name="apple-mobile-web-app-capable" content="yes">
<!-- Facebook -->
<meta property="og:title" content="mdsh">
<meta property="og:description" content="mdsh - a simple static site generator for modern websites, written in Bash.">
<meta property="og:url" content="/mdsh">
<meta property="og:site_name" content="mdsh">
<meta property="og:type" content="article">
<meta property="og:locale" content="en">
<meta property="og:image" content="/mdsh/assets/icons/rss.png">
<meta property="article:published_time" content="Sun Mar 3 19:27:03 +08 2019">
<!-- Twitter -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="mdsh" />
<meta name="twitter:site" content="@foobar" />
<meta name="twitter:image" content="/mdsh/assets/icons/rss.png" />
<!-- Linked data -->
<script id="meta-ld" type="application/ld+json">
{
  "@context": "http://schema.org/",
  "@type": "Article",
  "headline": "mdsh",
  "headlineAlternative": "mdsh",
  "datePublished": "Sun Mar 3 19:27:03 +08 2019",
  "dateModified": "Sun Mar 3 19:27:03 +08 2019",
  "description": "mdsh - a simple static site generator for modern websites, written in Bash.",
  "keywords": "mdsh, static site generator, project page, open source, blog, news, feed",
  "image": {
    "@type": "ImageObject",
    "height": "512",
    "width": "512",
    "url": "/mdsh/assets/icons/android-chrome-512x512.png"
  },
  "author": "sc0ttj",
  "publisher": {
    "@type": "Organization",
    "logo": {
      "@type": "ImageObject",
      "url": "/mdsh/assets/icons/android-chrome-512x512.png"
    },
    "name": "mdsh"
  },
  "mainEntityOfPage": "/mdsh",
  "articleBody": "mdsh - mdsh - a simple static site generator for modern websites, written in Bash."
}
</script>


<!-- RSS feed -->
<link rel="alternate" type="application/rss+xml" title="Subscribe to mdsh" href="/mdsh/feed.rss" />
<!-- SEO stuff -->
<link rel="author" href="/humans.txt" />
<link rel="canonical" href="/mdsh/">
<!-- App icons and favicons -->
<link rel="manifest" href="/mdsh/manifest.webmanifest?v=1551612423">
<link rel="icon" type="image/vnd.microsoft.icon" href="/mdsh/assets/icons/favicon.ico?v=1551612423">
<link rel="apple-touch-icon" sizes="180x180" href="/mdsh/assets/icons/apple-touch-icon.png?v=1551612423">
<link rel="shortcut icon" href="/mdsh/assets/icons/favicon.ico?v=1551612423">
<link rel="icon" type="image/png" sizes="16x16" href="/mdsh/assets/icons/favicon-16x16.png?v=1551612423">
<link rel="icon" type="image/png" sizes="32x32" href="/mdsh/assets/icons/favicon-32x32.png?v=1551612423">
<link rel="icon" type="image/png" sizes="192x192" href="/mdsh/assets/icons/android-chrome-192x192.png?v=1551612423">
<link rel="mask-icon" color="#444444" href="/mdsh/assets/icons/safari-pinned-tab.svg?v=1551612423">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-config" content="/mdsh/assets/icons/browserconfig.xml?v=1551612423">
<meta name="theme-color" content="#101010">
<!-- Fallback app name, for legacy browsers -->
<meta name="application-name" content="mdsh">

<style>
  body, input, select, textarea, button {
    font-family: Ubuntu, serif;
    font-size: 16px;
  }
  pre, code {
    font-family: Inconsolata, Monaco, monospace, serif;
    font-size: 14px;
  }
</style>
<link rel="stylesheet" href="/mdsh/assets/css/main.css?v=1551612423">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,400i,700|Inconsolata:400,400i,700|Monaco:400,400i,700&subset=latin,latin-ext">
<script class="unpkg" id="unpkg-cash-dom" defer src="//unpkg.com/cash-dom"></script>
<script class="unpkg" id="unpkg-jets" defer src="//unpkg.com/jets"></script>
<script id="appjs" defer src="/mdsh/assets/js/app.js?v=1551612423"></script>
</head>
<body>
<div class="main-container">
<div class="body-container">
<div class="page-header">
<h1><a href="/mdsh/index.html">mdsh</a></h1>
<input type="search" class="site-search" id="site-search" placeholder="search.." />
<a class="off-screen skip-to-content" href="#content">Skip to content</a>
<ul>
<li><a href="/mdsh/about.html">about</a></li>
<li><a href="/mdsh/archive.html">archive</a></li>
<li><a href="/mdsh/categories.html">categories</a></li>
<li><a href="/mdsh/contact.html">contact</a></li>
<li><a href="/mdsh/tags.html">tags</a></li>
</ul>
</div>
<div id="content" class="post-content">
<div class="post-preview">
<h2><a href="/mdsh/posts/2019/03/03/setting-up-your-blog.html">Setting up your blog</a></h2> <time datetime="2019-03-03">2019/03/03</time>
<ul class="post-meta">
<li>2 mins</li>
<li>2019/03/03</li>
<li>sc0ttj</li>
<li>@foobar</li>
<li><a href="/mdsh/categories/blog.html">blog</a></li>
</ul>
<ul class="tags">
<li><a href="/mdsh/tags/shell.html">shell</a></li>
</ul>
<p>I've added two new scripts, to make setting and managing your blog a little easier.</p>

<h3><code>server</code></h3>

<p>This script will start/stop the local webserver for you. It will work out the correct web root (the folder from which to run the server) by checking the <code>$blog_url</code> variable stored in <code>.site_config</code>.</p>

<h4><code>server</code> usage</h4>

<p><code>server start [port]</code> - start a server</p>

<p><code>server stop</code> - stop a running server</p>

<h3><code>setup</code></h3>

<p>This script gives an easy, interactive way to set your sites default values. It doesn't require any options, and it writes the settings you choose to <code>.site_config</code>.</p>

<h3>To do</h3>

<p>I need to update the documentation and <a href="https://github.com/sc0ttj/mdsh/wiki/">Wiki</a> to reflect these changes.</p>
</div><div class="post-preview">
<h2><a href="/mdsh/posts/2019/03/03/highlighting-search-terms-on-the-page.html">Highlighting search terms on the page</a></h2> <time datetime="2019-03-03">2019/03/03</time>
<ul class="post-meta">
<li>1 min</li>
<li>2019/03/03</li>
<li>sc0ttj</li>
<li>@foobar</li>
<li><a href="/mdsh/categories/blog.html">blog</a></li>
</ul>
<ul class="tags">
<li><a href="/mdsh/tags/javascript.html">javascript</a></li>
</ul>
<p>Using a <a href="https://stackoverflow.com/questions/41533785/how-to-highlight-search-text-in-html-with-the-help-of-js">jQuery plugin found at Stack Overflow</a>, we can add some functionality to <code>cash-dom</code> (Ken Wheelers excellent <a href="https://github.com/kenwheeler/cash">cash-JS</a>, a lightweight jQuery replacement) so that any search terms entered into the site search input (which appears at the top of many pages on this site) are highlighted in yellow.</p>

<p>Here is the code I've added to <code>assets/js/app.js</code>:</p>

<pre><code>
// add highlighting of searched items as a cash JS method/plugin
// from: https://stackoverflow.com/questions/41533785/how-to-highlight-search-text-in-html-with-the-help-of-js
$.fn.highlight = function(pat) {
function innerHighlight(node, pat) {
var skip = 0;

if (node.nodeType == 3) {
var pos = node.data.toUpperCase().indexOf(pat);

if (pos >= 0) {
var spannode = document.createElement("span");
spannode.className = "highlight";
var middlebit = node.splitText(pos);
var endbit = middlebit.splitText(pat.length);
var middleclone = middlebit.cloneNode(true);

spannode.appendChild(middleclone);
middlebit.parentNode.replaceChild(spannode, middlebit);
skip = 1;
}
} else if (
node.nodeType == 1 &&
node.childNodes &&
!/(script|style) /i.test(node.tagName)
) {
for (var i = 0; i < node.childNodes.length; ++i) {
i += innerHighlight(node.childNodes[i], pat);
}
}

return skip;
}

return this.each(function() {
innerHighlight(this, pat.toUpperCase());
});
};

$.fn.removeHighlight = function() {
function newNormalize(node) {
for (
var i = 0, children = node.childNodes, nodeCount = children.length;
i < nodeCount;
i++
) {
var child = children[i];

if (child.nodeType == 1) {
newNormalize(child);
continue;
}

if (child.nodeType != 3) {
continue;
}

var next = child.nextSibling;

if (next == null || next.nodeType != 3) {
continue;
}

var combined_text = child.nodeValue + next.nodeValue;
new_node = node.ownerDocument.createTextNode(combined_text);
node.insertBefore(new_node, child);
node.removeChild(child);
node.removeChild(next);
i--;
nodeCount--;
}
}

return this.find("span.highlight").each(function() {
var thisParent = this.parentNode;
thisParent.replaceChild(this.firstChild, this);
newNormalize(thisParent);
});
};

// add the event handler to the search input to call the highlighter
// pull in the new value

// remove any old highlighted terms

// disable highlighting if empty
if (searchTerm) {
// highlight the new term
}
});
</code></pre>

<p>In short, we added a new method to cash-js: <code>$.highlight()</code>, then use it to highlight matching items on the page.</p>
</div><div class="post-preview">
<h2><a href="/mdsh/posts/2019/03/03/custom-css-and-js-for-every-page.html">Custom CSS and JS for every page</a></h2> <time datetime="2019-03-03">2019/03/03</time>
<ul class="post-meta">
<li>1 min</li>
<li>2019/03/03</li>
<li>sc0ttj</li>
<li>@foobar</li>
<li><a href="/mdsh/categories/blog.html">blog</a></li>
</ul>
<ul class="tags">
<li><a href="/mdsh/tags/blog.html">blog</a></li>
<li><a href="/mdsh/tags/css.html">css</a></li>
<li><a href="/mdsh/tags/javascript.html">javascript</a></li>
</ul>
<p>I've implemented a super easy way to include custom JavaScript (JS) and CSS in any pages or posts you create using <code>mdsh</code>.</p>

<p>It is as simple as adding a <code>.css</code> or <code>.js</code> to the relevant folder in <code>assets/</code>, and giving the files the same name as the <code>.html</code> file in which you wish to include your custom scripts.</p>

<p>For example, this post, titled "Custom CSS and JS for every page" gets the filename <code>custom-css-and-js-for-every-page.html</code>.</p>

<p>So you can create the following CSS and JS files, and they will be <em>automatically</em> included in <code>custom-css-and-js-for-every-page.html</code> when building the page:</p>

<ul>
<li><code>assests/js/custom-css-and-js-for-every-page.js</code></li>
<li><code>assets/css/custom-css-and-js-for-every-page.css</code></li>
</ul>

<p>Note: If you create these custom CSS and JS scripts <strong>after</strong> you have written the post/page, it will need to be re-built using <code>update_pages -all</code> in order for them to be included.</p>

<p>Tip: Create any custom JS or CSS files you will need (even as empty files) <em>before</em> you run <code>create_post</code>, and you won't need to re-build the page.</p>

<p>The custom CSS is included <strong>after</strong> the <code>main.css</code> stylesheet.</p>

<p>The custom JS is included <strong>after</strong> the main <code>app.js</code> script.</p>
</div><div class="post-preview">
<h2><a href="/mdsh/posts/2019/03/02/searching-this-website.html">Searching this website</a></h2> <time datetime="2019-03-02">2019/03/02</time>
<ul class="post-meta">
<li>1 min</li>
<li>2019/03/02</li>
<li>sc0ttj</li>
<li>@foobar</li>
<li><a href="/mdsh/categories/blog.html">blog</a></li>
</ul>
<ul class="tags">
<li><a href="/mdsh/tags/blog.html">blog</a></li>
<li><a href="/mdsh/tags/javascript.html">javascript</a></li>
</ul>
<p>I've simplified the <code>assets/js/app.js</code> JavaScript file that is loaded in all pages by default.</p>

<p>The changes mean that more pages have a search box at the top, and are filterable/searchable.</p>

<p>The list of searchable pages include:</p>

<ul>
<li>homepage</li>
<li>categories and tags index pages</li>
<li>author pages</li>
<li>monthly and yearly index pages</li>
<li>archive page</li>
</ul>
</div><div class="post-preview">
<h2><a href="/mdsh/posts/2019/03/02/fixing-rss-generation.html">Fixing RSS generation</a></h2> <time datetime="2019-03-02">2019/03/02</time>
<ul class="post-meta">
<li>2 mins</li>
<li>2019/03/02</li>
<li>sc0ttj</li>
<li>@foobar</li>
<li><a href="/mdsh/categories/blog.html">blog</a></li>
</ul>
<ul class="tags">
<li><a href="/mdsh/tags/bsd.html">bsd</a></li>
<li><a href="/mdsh/tags/linux.html">linux</a></li>
<li><a href="/mdsh/tags/gnu.html">gnu</a></li>
<li><a href="/mdsh/tags/osx.html">osx</a></li>
</ul>
<p>I've made a few changes in the <code>./create_rss</code> function, so that it works on both Linux and Mac OS X:</p>

<ul>
<li>dont use the <code>-printf</code> option with <code>find</code></li>
<li>dont use <code>--rfc</code> option with <code>date</code></li>
<li>simplified sed commands</li>
<li>use simple find command to list files newest to oldest (with <code>sort -r</code>)</li>
<li>create RFC 2822 date formats using <code>date +"%a, %d %b %Y %T %z"</code></li>
</ul>

<p>Because there is no simple way to generate the dates with a command that works on both Linux and Mac, I use <code>uname</code> to check the OS type (Linux, Darwin, etc), then I set the date using one of two ways.</p>

<p>Here is the relevant code from <code>create_rss</code>:</p>

<pre><code>
if [ "$os_type" = "Linux" ];then
# use GNU date
pubDate=`date -r "$file" +"%a, %d %b %Y %T %z"`
force_update=`date -r "$file" "+%s"`
else # Mac, BSD
# use BSD date
pubDate=`date -r "$timestamp" +"%a, %d %b %Y %T %z"`
force_update=`date -r "$timestamp" "+%s"`
fi
</code></pre>

<p>Using this, the command <code>./create_rss posts/ &gt; feed.rss</code> that is used in <code>update_pages</code> should work on Linux, Mac and BSD.</p>
</div><div class="post-preview">
<h2><a href="/mdsh/posts/2019/03/02/adding-authors-pages.html">Adding authors pages</a></h2> <time datetime="2019-03-02">2019/03/02</time>
<ul class="post-meta">
<li>1 min</li>
<li>2019/03/02</li>
<li>sc0ttj</li>
<li>@foobar</li>
<li><a href="/mdsh/categories/blog.html">blog</a></li>
</ul>
<ul class="tags">
<li><a href="/mdsh/tags/blog.html">blog</a></li>
</ul>
<p>Author pages are now automatically generated when adding posts, in addition to the indexes already generated.</p>

<p>This means, that users can go to the <a href="/mdsh/authors/index.html">authors page</a> to see a list of all authors who've written posts on this blog.</p>

<p>Clicking on the author will take you to the <a href="/mdsh/authors/sc0ttj.html">list of posts they've written</a>.</p>

<p>This should make it a little easier to find what you need on the site.</p>

<h3>Further Improvements</h3>

<ul>
<li>List the authors index somewhere (in page header, or elsewhere)</li>
<li>In post header/footer, make authors name clickable (go to authors page, listing all their posts)</li>
</ul>
</div><div class="post-preview">
<h2><a href="/mdsh/posts/2019/02/24/generating-better-homepages.html">Generating better homepages</a></h2> <time datetime="2019-02-24">2019/02/24</time>
<ul class="post-meta">
<li>2 mins</li>
<li>2019/02/24</li>
<li>sc0ttj</li>
<li>@foobar</li>
<li><a href="/mdsh/categories/blog.html">blog</a></li>
</ul>
<ul class="tags">
<li><a href="/mdsh/tags/blog.html">blog</a></li>
</ul>
<p>I have improved the homepages generated by <code>mdsh</code> - they now list posts in full, including title, date, tags and the full body content.</p>

<p>There are still some improvements to be made - a link at the bottom to the archive page, so users can find all posts (not only the most recent).</p>

<p>Currently the number of posts on the homepage is limited to some hard-coded value (18, I think), this should be improved in future.</p>

<p>Pagination may also be useful, but implementing that might in a nice way might take some thought.</p>

<p>The homepages are generated using the function <code>print_post_preview</code>:</p>

<pre><code>
function print_post_preview {
[ ! "$1" ] && return 1

# $1 is the mdsh file
set_post_info "$1"

# exit if we are not building a blog post
[ "$post_slug" = "" ] && return 0

echo '&lt;div class="post-preview"&gt;'
echo '&lt;h2&gt;&lt;a href="'"${post_url}"'"&gt;'"${post_title}"'&lt;/a&gt;&lt;/h2&gt; &lt;datetime&gt;'"${post_created}"'&lt;/datetime&gt;'
echo '&lt;ul class="post-meta"&gt;'
echo '&lt;li&gt;'"${post_time_to_read}"'&lt;/li&gt;'
echo '&lt;li&gt;'"${post_created}"'&lt;/li&gt;'
echo '&lt;li&gt;'"${post_author}"'&lt;/li&gt;'
echo '&lt;li&gt;'"${post_twitter}"'&lt;/li&gt;'
echo '&lt;li&gt;&lt;a href="'${blog_url}'/categories/'"${post_category}"'.html"&gt;'"${post_category}"'&lt;/a&gt;&lt;/li&gt;'
echo '&lt;/ul&gt;'
echo '&lt;ul class="tags"&gt;'
for tag in ${post_tags//,/ }
do
echo '&lt;li&gt;&lt;a href="'${blog_url}'/tags/'${tag}'.html"&gt;'${tag}'&lt;/a&gt;&lt;/li&gt;'
done
echo '&lt;/ul&gt;'
# show only a summary (using the meta description)
#echo '&lt;p&gt;'"${post_descr}"'&lt;/p&gt;'
# show full post content, excluding main header (already in post preview)
echo '&lt;/div&gt;'
}
</code></pre>

<p>^ this function can be found in the <code>create_pages</code> script, and is run when the <code>update_pages</code> script re-builds the homepage (which happens automatically each time you create a new post, but can also be done manually by running <code>./update_pages [-all]</code>).</p>
</div><div class="post-preview">
<h2><a href="/mdsh/posts/2019/02/24/adding-a-site-search-feature.html">Adding a site search feature</a></h2> <time datetime="2019-02-24">2019/02/24</time>
<ul class="post-meta">
<li>1 min</li>
<li>2019/02/24</li>
<li>sc0ttj</li>
<li>@foobar</li>
<li><a href="/mdsh/categories/blog.html">blog</a></li>
</ul>
<ul class="tags">
<li><a href="/mdsh/tags/blog.html">blog</a></li>
<li><a href="/mdsh/tags/javascript.html">javascript</a></li>
</ul>
<p>I wanted <code>mdsh</code> to have a nice site search feature, and not have to use Google Custom Search Engine or similar.</p>

<p>I did not want a search that takes users away from the site, and I needed one which searched the site itself - not some extra JSON file of something (I don't want to have to update multiple files, I want to keep things DRY).</p>

<p>In the end, I decided to use <a href="https://github.com/NeXTs/Jets.js">Jets</a>.</p>

<p>The implementation works as follows:</p>

<ul>
<li>if the visitors browser does not support JS, they will not see the site search</li>
<li>if JS is supported, a search box will be visible in the top-right of the page</li>
<li>some JS code in <code>app.js</code> will determine which HTML element to search inside</li>
<li>typing into the search box will hide element in the given container which don't match the search terms</li>
<li>on the archive page, the container used is <code>.archive-posts</code></li>
<li>on the categories page, the container is <code>.categories-list</code></li>
<li>on the tags page, the container used is <code>.tags-list</code></li>
<li>on the homepage, the container used is '#content'</li>
<li>the search box is disabled on other pages (which dont contain lists of things to search)</li>
</ul>

<p>Possible improvements:</p>

<ul>
<li>use Google Custom Search Engine as a no JS fallback</li>
</ul>
</div><div class="post-preview">
<h2><a href="/mdsh/posts/2019/02/23/generating-an-xml-sitemap.html">Generating an XML sitemap</a></h2> <time datetime="2019-02-23">2019/02/23</time>
<ul class="post-meta">
<li>1 min</li>
<li>2019/02/23</li>
<li>sc0ttj</li>
<li>@foobar</li>
<li><a href="/mdsh/categories/blog.html">blog</a></li>
</ul>
<ul class="tags">
<li><a href="/mdsh/tags/blog.html">blog</a></li>
<li><a href="/mdsh/tags/xml.html">xml</a></li>
</ul>
<p>Here is a script which generates a valid XML sitemap, which Google (and others) will use to index your site:</p>

<pre><code>
#!/bin/bash

# generate an XML sitemap for this site

# script adapted from: http://www.lostsaloon.com/technology/how-to-create-an-xml-sitemap-using-wget-and-shell-script/

. .site_config

sitedomain=https://sc0ttj.github.io/mdsh/

mv sitemap.xml sitemap_prev.xml

echo "Generating sitemap.xml, please wait.."

wget --spider --recursive --level=inf --no-verbose --output-file=linklist.txt "$sitedomain"
grep -i URL linklist.txt | awk -F 'URL:' '
{print $2}' | awk '{$1=$1};1' | awk '{print $1}' | sort -u | sed '/^$/d' > sortedurls.txt

header='&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;urlset
      xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.sitemaps.org/schemas/sitemap/0.9
            http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd"&gt;'

echo "$header" > sitemap.xml

while read p; do
  case "$p" in
  */ | *.html | *.htm)
    echo '&lt;url&gt;&lt;loc&gt;'$p'&lt;/loc&gt;&lt;/url&gt;' >> sitemap.xml
    ;;
  *)
    ;;
 esac
done < sortedurls.txt

echo "&lt;/urlset&gt;" >> sitemap.xml

rm linklist.txt sortedurls.txt &>/dev/null

[ ! -f sitemap.xml ] && exit 1

rm sitemap_prev.xml

echo "Publishing sitemap.."
echo
git add sitemap.xml
git commit -m 'Updated sitemap'
git push origin gh-pages

exit 0
</code></pre>
</div><div class="post-preview">
<h2><a href="/mdsh/posts/2019/02/23/generating-an-rss-feed.html">Generating an RSS feed</a></h2> <time datetime="2019-02-23">2019/02/23</time>
<ul class="post-meta">
<li>1 min</li>
<li>2019/02/23</li>
<li>sc0ttj</li>
<li>@foobar</li>
<li><a href="/mdsh/categories/blog.html">blog</a></li>
</ul>
<ul class="tags">
<li><a href="/mdsh/tags/blog.html">blog</a></li>
<li><a href="/mdsh/tags/rss.html">rss</a></li>
</ul>
<p>Here is the bash script used by this site to generate rss feeds.</p>

<p>The usage (in <code>update_pages</code>) is <code>./create_rss posts/ &gt; feed.rss</code>.</p>

<p>Here is the script: <a href="/mdsh/create_rss">create_rss</a></p>
</div><div class="post-preview">
<h2><a href="/mdsh/posts/2019/02/17/adding-a-stylesheet.html">Adding a stylesheet</a></h2> <time datetime="2019-02-17">2019/02/17</time>
<ul class="post-meta">
<li>3 mins</li>
<li>2019/02/17</li>
<li>John Doe</li>
<li>@foobar</li>
<li><a href="/mdsh/categories/blog.html">blog</a></li>
</ul>
<ul class="tags">
<li><a href="/mdsh/tags/blog.html">blog</a></li>
<li><a href="/mdsh/tags/css.html">css</a></li>
</ul>
<p>I've added a stylesheet for this site, <code>assets/css/main.css</code>.</p>

<p>The main classes are:</p>

<p><code>.main-container</code> - all site content goes in this container</p>

<p><code>.body-container</code> - contains everything except the site footer</p>

<p><code>.footer</code> - the site footer</p>

<p><code>.page-header</code> - the main header at the top of every page</p>

<p><code>.post-content</code> - contains the post title and body content</p>

<p><code>.post-header</code> - contains post meta info (author, category, etc)</p>

<p><code>.post-footer</code> - same as post header, but appears <strong>below</strong> post body content</p>

<p>There are other classes inside those, the most important of which are:</p>

<p><code>.post-meta</code> - inside <code>.post-header</code> and <code>.post-footer</code>, contains the post meta info</p>

<p><code>.prev-next-posts</code> - inside <code>.post-footer</code> only, last item before <code>.footer</code></p>

<p>All of the lists of posts on the site will have the class <code>.posts</code>, with added classes to differentiate them from each other:</p>

<p><code>.archive-posts</code> - the list of posts on the archive page</p>

<p><code>.recent-posts</code> - the list of posts on the homepage</p>

<p><code>.posts-in-category</code> - the list of posts in <code>category/&lt;category-name&gt;.html</code></p>

<p><code>.posts-matching-tag</code> - the list of posts in <code>tags/&lt;tag-name&gt;.html</code></p>

<p>The classes above can be targed in your CSS to style the page, and you can create additional stylesheets that will be automatically included on your generated pages by giving those stylesheets filenames with match the html files on your site. For example, when you generate <code>categories.html</code>, the additional css file <code>assets/css/categories.css</code> will be included in the <code>&lt;head&gt;</code> of the page, if it exists.</p>

<p>So, you can edit the styles in <code>assests/css/main.css</code>, or create a stylesheet for individual pages - just make sure the HTML files have stylesheets with matching filenames in <code>assets/css/</code>.</p>

<p>Here is the contents of the main stylesheet (so far):</p>

<pre><code>
html,
body {
  box-sizing: border-box;
  font-size: 16px;
  line-height: 1.4em;
  min-height: 100vh;
  margin: 0;
  padding: 0;
}

/* body bg color */
body {
  background-color: #333;
}

/* extra line height for para text */
p {
  line-height: 1.6em;
}

/* heades and inline code elems */
code {
  background-color: #eee;
  color: #000;
  display: inline;
  padding: 0;
  margin: 0;
}

h1,
h1 code {
  font-size: 32px;
}

h2,
h2 code {
  font-size: 24px;
}

h3,
h3 code {
  font-size: 20px;
}

h4,
h4 code {
  font-size: 18px;
}

p code,
li code {
  font-size: 16px;
}

h1 code,
h2 code,
h3 code,
h4 code,
p code,
li code,
span code {
  /* enable padding in inline snippets */
  display: inline-block;
  line-height: 18px;
  padding: 1px 6px;
  margin-left: 2px;
  margin-right: 1px;
  vertical-align: middle;
}

/* code blocks */
pre {
  background-color: #eee;
  color: #000;
  font-size: 15px;
  line-height: 18px;
  overflow-x: auto;
  padding: 12px;
  padding-top: 0;
  word-break: break-all;
  word-wrap: break-word;
}

/* off screen text in site header */
.off-screen {
  clip: rect(1px 1px 1px 1px); /* IE 6/7 */
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  left: -999em;
  overflow: hidden;
  position: absolute;
  white-space: nowrap; /* added line */
  width: 1px;
}

/* wraps around all content */
.main-container {
  background-color: #fff;
  color: #222;
  height: 100%;
  min-height: 100%;
  min-height: 100vh;
  max-width: 800px;
  margin: 0px auto;
  padding: 0;
  padding-bottom: 0; /* height of footer .. OR -1px and add padding-bottom to .body-container */
  padding-top: -1px; /* pushes container to top of page */
  position: relative;
  width: 100%;
}

.body-container {
  padding-bottom: 62px;
}

/* main site header */
.page-header {
  background-color: #101010;
  color: #fff;
  font-weight: bold;
  margin-top: -1px;
  padding: 18px;
  padding-bottom: 1px;
}

.page-header h1 {
  margin-top: 6px;
}

.page-header a {
  text-decoration: none;
}

.page-header a,
.page-header a:visited {
  color: #f0f0f0;
}

.page-header a:hover,
.page-header a:focus {
  color: #fff;
  text-decoration: underline;
}

.page-header ul {
  list-style: none;
  margin-left: 0;
  padding-left: 0;
}

.page-header li {
  display: inline-block;
  padding-right: 8px;
}

.skip-to-content:focus {
  background: #fff;
  border: 2px solid #bbb;
  color: #000;
  clip: initial;
  display: block;
  height: auto;
  overflow: initial;
  padding: 12px 24px;
  position: absolute;
  top: 12px;
  left: 12px;
  width: auto;
  z-index: 10;
}

a.skip-to-content,
a.skip-to-content:hover,
a.skip-to-content:focus {
  color: #222;
}

/* post header */
.post-header {
  font-style: italic;
}

.post-header .post-meta .category,
.post-header .post-meta .author,
.post-header .post-meta .twitter {
  display: none;
}

.post-header .post-meta .time-to-read,
.post-header .post-meta .date {
  display: block;
}

.post-header .post-meta .time-to-read:before {
  content: "Time to read: ";
  display: inline-block;
  width: 100px;
}

.post-header .post-meta .date:before {
  content: "Published: ";
  display: inline-block;
  width: 100px;
}

/* tags */
.post-header .tags:before,
.post-footer .tags:before {
  content: "Tags: ";
  display: inline-block;
  width: 95px;
}

/* main content */

/* add padding to sections inside main container */
.post-content,
.post-footer {
  padding: 0;
  padding-left: 18px;
  padding-right: 18px;
}

@media (min-width: 640px) {
  .post-content,
  .post-footer {
    padding: 0;
    padding-left: 72px;
    padding-right: 72px;
  }
}

ul.posts,
ul.categories,
ul.tags {
  list-style: none;
  list-style-position: inside;
  margin-left: 0;
  padding-left: 0;
}

/* target all post lists on the site */
ul.posts li {
  /* auto trunate and append ... */
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
}

/* post footer */
.post-footer {
  font-style: italic;
  margin: 0 auto;
  margin-top: 12px;
}

.post-footer .post-meta .category:before {
  content: "Category: ";
  display: inline-block;
  width: 100px;
}

.post-footer .post-meta .category {
  display: block;
}

.post-footer .post-meta .twitter,
.post-footer .post-meta .time-to-read,
.post-footer .post-meta .date {
  display: none;
}

.post-footer .post-meta .author:before {
  content: "Author: ";
  display: inline-block;
  width: 100px;
}

.post-footer .post-meta .author {
  display: inline-block;
}

.post-footer .tags {
  display: none;
}

.prev-next-posts {
  font-style: italic;
  list-style: none;
  padding: 0;
}

.prev-next-posts span {
  display: inline-block;
  width: 96px;
}

.footer {
  position: absolute;
  background-color: #101010;
  color: #fff;
  bottom: 0;
  margin: 0 auto;
  text-align: center;
  width: 100%;
}
</code></pre>
</div><div class="post-preview">
<h2><a href="/mdsh/posts/2019/02/16/missing-post-header.html">Missing post header</a></h2> <time datetime="2019-02-16">2019/02/16</time>
<ul class="post-meta">
<li>1 min</li>
<li>2019/02/16</li>
<li>John Doe</li>
<li>@foobar</li>
<li><a href="/mdsh/categories/blog.html">blog</a></li>
</ul>
<ul class="tags">
<li><a href="/mdsh/tags/blog.html">blog</a></li>
</ul>
<p>This post should have a <code>h2</code> title called "Missing post header" .. The previous post (now fixed) was generated but had a missing header.</p>

<p>This was because <code>mdshell</code> was not appending to the <code>.md</code> file, but overwriting it with the post contents.</p>

<p>This was wrong, cos <code>create_post</code> already creates the <code>.md</code> file, with a <code>h2</code> header at the top.</p>

<p>Should be fixed now.</p>
</div><div class="post-preview">
<h2><a href="/mdsh/posts/2019/02/16/ifs-and-the-read-command.html">IFS and the read command</a></h2> <time datetime="2019-02-16">2019/02/16</time>
<ul class="post-meta">
<li>1 min</li>
<li>2019/02/16</li>
<li>John Doe</li>
<li>@foobar</li>
<li><a href="/mdsh/categories/blog.html">blog</a></li>
</ul>
<ul class="tags">
<li><a href="/mdsh/tags/blog.html">blog</a></li>
<li><a href="/mdsh/tags/shell.html">shell</a></li>
</ul>
<p>In order to (finally) get the <code>.mdsh</code> files to generate valid markdown, and from there to convert to valid HTML, while <strong>also</strong> preserving code block formatting (new lines, indentations, etc), I had to set IFS and use the <code>-er</code> options of the read command.</p>

<h3>About <code>IFS</code></h3>

<blockquote>
  <p>The Internal Field Separator (IFS) that is used for word splitting after expansion and to split lines into words with the read builtin command.</p>
</blockquote>

<p>The <code>IFS</code> variable is a special Bash/shell variable which commands like <code>read</code> use to workout what counts as a field separator.</p>

<p>By default, it is usually set to new lines and spaces.</p>

<p>In order to parse our the markdown generated from our <code>.mdsh</code> files, we set IFS to parse new lines only (ignoring spaces).</p>

<h3>About the <code>read</code> command</h3>

<p>The <code>read</code> command is built-in to bash, and used to read input from the terminal input, or stdin.</p>

<p>In order to read the markdown we generated line by line, while also preserving formatting, we need to set <code>IFS</code> as described above, <strong>and</strong> to set the <code>-er</code> params for <code>rread</code> so that backslashes are interpreted literally.</p>

<p>After doing that, these paras you're reading will be converted to p tags in the HTML, and the code blocks will preserve their formatting too.</p>

<p>See previous posts for examples of embedded code blocks for examples.</p>
</div><div class="post-preview">
<h2><a href="/mdsh/posts/2019/02/16/auto-generated-post-footers.html">Auto-generated post footers</a></h2> <time datetime="2019-02-16">2019/02/16</time>
<ul class="post-meta">
<li>1 min</li>
<li>2019/02/16</li>
<li>John Doe</li>
<li>@foobar</li>
<li><a href="/mdsh/categories/blog.html">blog</a></li>
</ul>
<ul class="tags">
<li><a href="/mdsh/tags/blog.html">blog</a></li>
</ul>
<p>I've added a new feature - a very simple one.</p>

<p>The "post header" containing category, time to read, author etc (see above) is now also added to the bottom of each post, above the main site footer.</p>

<p>This way, it will be very easy to create different layouts in CSS, by hiding/showing post info above/below the post.</p>

<p>It's a bit inefficient, but simple and flexible.</p>
</div><div class="post-preview">
<h2><a href="/mdsh/posts/2019/02/15/test.html">test</a></h2> <time datetime="2019-02-15">2019/02/15</time>
<ul class="post-meta">
<li>1</li>
<li>2019/02/15</li>
<li>John Doe</li>
<li>@foobar</li>
<li><a href="/mdsh/categories/test.html">test</a></li>
</ul>
<ul class="tags">
<li><a href="/mdsh/tags/test.html">test</a></li>
</ul>
<p>foo</p>

<p>bar</p>

<pre><code>
#!/bin/bash

if [ "$1" = '-h' ] || [ "$1" = '-help' ] || [ "$1" = '--help' ];then

  echo
  echo 'This script gets the repo URLs listed in /etc/apt/sources.list and '
  echo '/etc/apt/sources.list.d/<name>.list then passes them to `ppa2pup`, '
  echo 'which creates a Puppy-compatible repo from the repo URLs it receives '
  echo '(if possible).'
  echo
  echo 'More info:'
  echo
  echo '/etc/apt/sources.list usually contains lines like:'
  echo
  echo '    deb     https://deb.nodesource.com/node_8.x      trusty       main'
  echo '    deb     http://apt.postgresql.org/pub/repos/apt  trusty-pgdg  main'
  echo '    deb-src http://apt.postgresql.org/pub/repos/apt  trusty-pgdg  main'
  echo
  echo 'The first bit refers to package type (regular or source), the second'
  echo 'is the URL where the packages are, the third is OS version, and '
  echo 'the last is the "repo stream" - often main, contrib, or non-free.'
  echo
  echo 'This script will ignore "deb-src" entries, and parse the others'
  exit 0

fi

if [ ! -f /etc/apt/sources.list ] && [ ! -d /etc/apt/sources.list.d/ ];then
  [ ! -f /etc/apt/sources.list    ] && echo 'File /etc/apt/sources.list     not found'
  [ ! -d /etc/apt/sources.list.d/ ] && echo 'Dir  /etc/apt/sources.list.d/  not found'
  echo 'Exiting'
  exit 1
fi

# search inside /etc/apt/sources.list /etc/apt/sources.list.d/*.list
# ...look for lines starting with 'deb ', ignore others
# ...(use grep -h, to remove the preppended filenames if grepping multiple files)
# ...remove any arch stuff from the entries, ppa2pup will handle that,
# ...convert spaces to | chars, so we can process each line as a whole later
apt_sources_list="$(grep -h '^deb ' /etc/apt/sources.list /etc/apt/sources.list.d/*.list 2>/dev/null \
  | sed \
    -e "s/^deb //g" \
    -e "s/^tor+//g" \
    -e 's/\[arch=[a-z,0-9].*\] //g' \
    -e 's/ /|/g'\
)"

echo "Repos to process:"
echo
echo "${apt_sources_list//|/ }"


# for each repo in $apt_sources_list, use `ppa2pup` to install the repo
for line in $apt_sources_list
do
  [ "$line" = "" ] && continue
  [ "$line" = "
" ] && continue
  echo
  echo "Processing:  ${line//|/ }"
  echo

  # ask user to update repo
  read -r -N 1 -p "Update repo from '$(echo ${line//|/ } | cut -f1 -d' ')'? [y/n] " ANSWER

  if [ "$ANSWER" = 'y' ] || [ "$ANSWER" = 'Y' ];then
    echo
    ppa2pup ${line//|/ }
    retval=$?
  fi
  echo
done

exit $retval
</code></pre>

<p>more</p>
</div><div class="post-preview">
<h2><a href="/mdsh/posts/2019/02/15/tester.html">tester</a></h2> <time datetime="2019-02-15">2019/02/15</time>
<ul class="post-meta">
<li>1 min</li>
<li>2019/02/15</li>
<li>John Doe</li>
<li>@foobar</li>
<li><a href="/mdsh/categories/test.html">test</a></li>
</ul>
<ul class="tags">
<li><a href="/mdsh/tags/test.html">test</a></li>
</ul>
<p>some para</p>

<p>do a uname:</p>

<pre><code>
Linux
</code></pre>

<p>^ should say <code>Linux</code></p>

<p>do multi line cat:</p>

<pre><code>
#!/bin/sh

romdir="/root/network/MAINPC--rootfs/mnt-point/mnt/sdb1/Games"
[ -d "$2" ] && romdir="$2"

# choose a system dir to look in for roms
find "$romdir" \
    -maxdepth 1 \
    -mindepth 1 \
    -type d \
  | sed "s#.*/##g" \
  | sort -u \
  | rofi -dmenu \
      -p 'Enter name: ' \
      -i -mesg 'Choose a system to play' > /tmp/rofi_system_name

system_name="$(cat /tmp/rofi_system_name 2>/dev/null)"

if [ "$system_name" = "" ] || [ ! -d "$romdir/$system_name" ];then
 exit 1
fi


# looks for, list and choose a rom
find $romdir/$system_name \
    -maxdepth 2 \
    -mindepth 1 \
    -type f \
    -iname "*.cue" -or -iname "*.ccd" -or -iname "*.iso" -or -iname "*.zip" \
    -or -iname "*.smc" -or -iname "*.smd" -or -iname "*.gb" -or -iname "*.gbc" \
    -or -iname "*.gba" \
  | sed -e 's#.*/##g' \
  | sort -u \
  | rofi -dmenu -p 'Enter name: ' -i -mesg 'Choose a ROM to play' > /tmp/rofi_rom_name;

# rom name, escape [ and ]
romname="$(cat /tmp/rofi_rom_name | sed -e 's/\[/\[/g' -e 's/\]/\]/g')"
[ "$romname" = "" ] && exit 1

romfile="$(find "$romdir/$system_name" -maxdepth 2 -mindepth 1 -type f -iname "*${romname}*")"


if [ ! -f "$romfile" ];then
  rofi -dmenu -mesg "Rom file '$romname' not found!"
  exit 1
fi


case $system_name in
  *)
    # run the chosen game
    mednafen "$romfile"
    exit $?
    ;;
esac
</code></pre>

<p>^ rofnafen</p>

<p>...</p>
</div><div class="post-preview">
<h2><a href="/mdsh/posts/2019/02/15/rof-test.html">rof test</a></h2> <time datetime="2019-02-15">2019/02/15</time>
<ul class="post-meta">
<li>1 min</li>
<li>2019/02/15</li>
<li>John Doe</li>
<li>@foobar</li>
<li><a href="/mdsh/categories/test.html">test</a></li>
</ul>
<ul class="tags">
<li><a href="/mdsh/tags/test.html">test</a></li>
</ul>
<pre><code>
#!/bin/sh

romdir="/root/network/MAINPC--rootfs/mnt-point/mnt/sdb1/Games"
[ -d "$2" ] && romdir="$2"

# choose a system dir to look in for roms
find "$romdir" \
    -maxdepth 1 \
    -mindepth 1 \
    -type d \
  | sed "s#.*/##g" \
  | sort -u \
  | rofi -dmenu \
      -p 'Enter name: ' \
      -i -mesg 'Choose a system to play' > /tmp/rofi_system_name

system_name="$(cat /tmp/rofi_system_name 2>/dev/null)"

if [ "$system_name" = "" ] || [ ! -d "$romdir/$system_name" ];then
 exit 1
fi


# looks for, list and choose a rom
find $romdir/$system_name \
    -maxdepth 2 \
    -mindepth 1 \
    -type f \
    -iname "*.cue" -or -iname "*.ccd" -or -iname "*.iso" -or -iname "*.zip" \
    -or -iname "*.smc" -or -iname "*.smd" -or -iname "*.gb" -or -iname "*.gbc" \
    -or -iname "*.gba" \
  | sed -e 's#.*/##g' \
  | sort -u \
  | rofi -dmenu -p 'Enter name: ' -i -mesg 'Choose a ROM to play' > /tmp/rofi_rom_name;

# rom name, escape [ and ]
romname="$(cat /tmp/rofi_rom_name | sed -e 's/\[/\[/g' -e 's/\]/\]/g')"
[ "$romname" = "" ] && exit 1

romfile="$(find "$romdir/$system_name" -maxdepth 2 -mindepth 1 -type f -iname "*${romname}*")"


if [ ! -f "$romfile" ];then
  rofi -dmenu -mesg "Rom file '$romname' not found!"
  exit 1
fi


case $system_name in
  *)
    # run the chosen game
    mednafen "$romfile"
    exit $?
    ;;
esac
</code></pre>

<p>more..</p>
</div><div class="post-preview">
<h2><a href="/mdsh/posts/2019/02/15/it-works-easier-post-editing-and-converting-is-on-the-way.html">It works! Easier post editing and converting is on the way...</a></h2> <time datetime="2019-02-15">2019/02/15</time>
<ul class="post-meta">
<li>2 mins</li>
<li>2019/02/15</li>
<li>John Doe</li>
<li>@foobar</li>
<li><a href="/mdsh/categories/blog.html">blog</a></li>
</ul>
<ul class="tags">
<li><a href="/mdsh/tags/blog.html">blog</a></li>
<li><a href="/mdsh/tags/markdown.html">markdown</a></li>
<li><a href="/mdsh/tags/mdsh.html">mdsh</a></li>
</ul>
<p>After the last fix, and as described in previous posts, each time you create a post, this blog tool thing will now save 3 files:</p>

<ul>
<li><code>file.mdsh</code> - a custom format, contains post meta info, markdown, html, embedded sub-shell commands</li>
<li><code>file.md</code> - a valid markdown file, contains only post body and the <strong>results</strong> of any embedded sub-shell commands</li>
<li><code>file.html</code> - a valid HTML file generated from the <code>.md</code> file</li>
</ul>

<p>So, as of this post, it will be easier to:</p>

<ul>
<li>convert the posts into PDF, bbcode, or some other format</li>
<li>edit existings posts - just edit the md file and run <code>update_pages -all</code></li>
</ul>

<h3>To do</h3>

<p>I still need to update <code>mdshell</code> so it can re-parse existing <code>.mdsh</code> files, not just take input form the user via the terminal.</p>

<p>After that is implemented, you will be able to edit any existing <code>.mdsh</code> files and generate the <code>.md</code> and <code>.html</code> from those.</p>
</div>
</div>
</div>
<div class="footer">
<p>© mdsh 2019. Powered by <a href=https://sc0ttj.github.io/mdsh/>mdsh</a></p>
</div>
</div>
</body>
</html>
